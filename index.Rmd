---
title: "index.Rmd"
author: "Annika Lehmus-Sun"
date: "February, 25, 2017"
email: "annika.lehmus@helsinki.fi"
output:
  html_document:
    theme: yeti
    toc: true
    toc_depth: 2
    fig_caption: true
    fig_width: 6
    fig_height: 4
    code_folding: hide
---

##Data, year and variables and research question: does x, y, c and b affect one's satisfaction in life?  
## bases the knowledfe of Martha Nussbaums list of capabilities that affects people's well-being: life satisfaction as indicator of subjective well-being and the other variables indicators of objective (capability) well-being factors. data wrangling can be found from HERE 

```{r}
if (!require("pacman")) install.packages("pacman")
pacman::p_load(haven, ggplot2,knitr, pander,descr,foreign,dplyr,Hmisc,psych,GPArotation,plyr, dplyr, rmarkdown)
BHPS <- read.csv(file = "/Applications/IODS-final/data/BHPS2.csv", sep=",")
BHPS$X <- NULL
```
## Information about the data
```{r}
dim(BHPS)
describe(BHPS)
```

## Variables
```{r}

variables <- matrix(c("QUESTION ASKED","If you could choose, would you stay here in your present home or would you prefer to move somewhere else?","Does your accommodation have any of the following problems? Vandalism or crime in the area", "Tell me which things you (and your household) have or do? Pay for a week’s annual holiday away from home.","Would you like to be able to pay for a week’s annual holiday away from home, but must do without because you cannot afford it?", "Tell me which things you (and your household) have or do? Buy new, rather than second hand, clothes.","Would you like to be able to buy new, rather than second hand, clothes, but must do without because you cannot afford it?","Tell me which things you (and your household) have or do? Have friends or family for a drink or meal at least once a month","How dissatisfied or satisfied are you with your life overall?"), ncol = 1, byrow =TRUE)
colnames(variables) <- c("BHPS 2000")
rownames(variables) <- c("VARIABLE NAME", "JLKMOVE", "JHSPRBQ","JHSCANB" , "JHSCNTB","JHSCAND", "JHSCNTD", "JHSCANF", "JLFSATO" )
variables <- as.table(variables)
variables
```


#### General information about the variables
```{r}
summary(BHPS, digits = 2)

```


Next I will present a graphical overview of the dataset "learning2014". The graph below gives hints of correlations between variables. According to the graph, it seems that there are rather little correlations between the learning approaches, gender and age with the exam points. Contrary, the strongest correlation is with the atttitude and points. 

```{r, echo= FALSE}

library(GGally)
library(ggplot2)
BHPS$JHSCANB <- as.character(BHPS$JHSCANB)
BHPS$JHSCANB[BHPS$JHSCANB == 1] <- "YES"
BHPS$JHSCANB[BHPS$JHSCANB == 2] <- "NO"
BHPS$JHSCANB[BHPS$JHSCANB < 0] <- "NA"

p <- ggpairs(BHPS, mapping = aes(col=JHSCANB, alpha = 0.01), lower = list(combo = wrap("facethist", bins = 5)))
p


```
##Based on the graphical overview of the data, it seems that attitude correlates greatly with points. Let’s take a closer look of all the variables:


##Let’s take a look at the relationship graphically: attitude indeed seems to have certain correlations with the points, unlike learning approach (deep). Surprinsingly the age and learning approach surface seems to have a small correlation among the male (and slightly with female) students. The older the student is the less he is likely to use learning approach “surface”. Similar correlation did not happen with other two learning approaches (deep and strategic).
JGHQC = experience of valuable/useful, JHSCANF = dinner/drink with friends/familu, JGHQF = capability to overcome difficultie, JLKMOVE = capability to move, JHLLT = health limits
```{r}
library(ggplot2)

p1 <- ggplot(BHPS, aes(x = JGHQC, y = JGHQF, col = JHLLT))
# define the visualization type (points)
p2 <- p1 + geom_point()
# draw the plot
p2
# add a regression line
p3 <- p2 + geom_smooth(method = "lm")
p3
# add a main title and draw the plot
p4 <- p3 + ggtitle("Student's attitude versus exam points")
p4

```


####Based on the graphical overview of the data, it seems that attitude correlates greatly with points. Let's take a closer look of all the variables:

#### ### Regression analysis: relationship of attitude, deep learning approach, age, and exam points as a dependent
####Regression model and analysis is probably one of hte most used method for predicting correlations between variables - to understand how certain independent variables (in my model that is attitude, deep learning approach and age) are related to the dependent variable (that is in this model examp points). Regression analysis helps to investigate different dimensions of the relationship and correlations. However, it is good to keep in mind that correlation does not (always) mean causality. (Armstrong, 2012.) The model1 (below) shows the correlations of the  independent variable and dependent variable.
#First linear regression model with all the variables - and then the ones that had the significant results 
##Regression model and analysis is probably one of hte most used method for predicting correlations between variables - to understand how certain independent variables (in my model that is attitude, deep learning approach and age) are related to the dependent variable (that is in this model examp points). Regression analysis helps to investigate different dimensions of the relationship and correlations. However, it is good to keep in mind that correlation does not (always) mean causality. (Armstrong, 2012.) The model1 (below) shows the correlations of the independent variable and dependent variable.
```{r, echo= FALSE}
Model1 <- lm(JLFSATO~JVOTE7+JGHQC+JHSCANF+JHSCNTD+JHSCAND+JHSCNTB+JHSCANB+JGHQH+JGHQF+JGHQD+JHSPRBQ+JLKMOVE+JHLLT , data = BHPS)
summary(Model1)
```

### Interesting enough, only five variables seems to have significant correlation with life satisfaction. No other variables (i.e. any learning approaches, age nor gender) have statisctical signifance with the students’ exam points other than attitude. Thus, since there is no statistical significanse between age and deep learning approach, I will remove those two variables, and create a model2, with only attitude as independent variable and exam point as dependent variable. Although should we ignore the variables that does not have statistical significance, perhaps not. In the articel “Statistical errors. P values, ‘the gold standard’ of statistical validity, are not as reliable as many scientist assume”, Regina Nuzzo summarizes how nowadays P value of 0.01 means for a lot of scientists that there is just a 1% of chance that the result is being a false. However, p value does not tell that. All what P value is doing, is summarizing the data by asuuming a spexifix null hypothesis (=that there is no correaltion between these variables, but our world does not work like that, usually variables do correlate). (Nuzzo, 2014.)

##P value tells us yet something about existing correlation. Therefore, let’s take a closer look at regression model “model2”, where attitude towards statistics is an independent variable (since it was the only one with a statistical significance) and exam points a dependent variable:
## significant factors JHGQC = experience of valuable/useful, JHSCANF = dinner/drink with friends/familu, JGHQF = capability to overcome difficultie, JLKMOVE = capability to move, JHLLT = health limits

```{r}
Model2 <- lm(JLFSATO~JGHQC+JHSCANF+JGHQF+JLKMOVE+JHLLT , data = BHPS)
summary(Model2)
```

### According to the model2, we can say that it seems like that, when the students’ attitude towards statistics rises also her/his exam point rises. The result is statistically significant (nevertheless, it is good to keep in mind Nuzzo’s argument of P value). The multiple R-squared of model2 is 0.19 (19%). R-squared measures how close the data is to the fitted regression line. It is the percentage of the response variable variation i.e. dependent variable, in model2 that is exam points, that is explained by a linear model. (Frost, 2013) Conclusively, attitude variable explains some variation of examp points, not extensively though.

Next I will provide following diagnostic plots: (1) Residuals vs Fitted values, (2) Normal QQ-plot and (3) Residuals vs Leverage. Residuals vs fitted values plot tells us how well the model (in this case model2) fits the data, and it could fit better. We find pretty equally spread residuals around horizontal line in Fitted values- plot, it is a indication that there is not non-linear relationship between exam points and attitude. In comparison, normal QQ-plot shows us if the residuals are normally distributed. According to the Tehroeticial Quonatiles - plot (below) shows how residuals are lined well on the straight dashed line, which means that they are quite normally distributed. The last one, Residual vs leverage plot shows possible influential cases. According to the Levarage -plot shows that there is not influential case(s), you can easily see that all the cases are inside Cook’s distance lines (if there was an influential case, it would show in the upper and lower right corner).

then some visualization JHGQC = experience of valuable/useful, JHSCANF = dinner/drink with friends/familu, JGHQF = capability to overcome difficultie, JLKMOVE = capability to move, JHLLT = health limits

```{r, echo=FALSE}
library(ggplot2)
plot(Model2, 1, par(mfrow = c(2,2)))
plot(Model2, 2, par(mfrow = c(2,2)))
plot(Model2, 5, par(mfrow = c(2,2)))

plot(Model2, which = c(1,2,5), par(mfrow = c(2,2)))
```

```{r}

qplot(BHPS$JGHQC, BHPS$JLFSATO) + geom_smooth(method = "lm")

ggplot(BHPS, aes(JLFSATO) + geom_errorbar(ymin=0.03, ymax=0.06, width=.2) + ylim(0, 1) +
geom_segment(x = 0, xend = 1, y = 0.52 + 0.01, yend = 0.52 + 0.01*1, colour="green") +    xlim(0, 1) +  geom_errorbar(ymin=0.01, ymax=0.03, width=.2) + ylim(0, 1)

ggplot(BHPS, aes(JLFSATO)) + stat_summary(fun.y=mean, geom="line") + ylab("predicted life satisfcation") + ylim(0,1) +  
  geom_segment(x = 0, xend = 1, y = 0.52 + 0.01, yend = 0.52 + 0.01*1, colour="green") +    xlim(0, 1) 

p1 <- ggplot(BHPS, aes(x = BHPS$JLFSATO, y = BHPS$JGHQF,  col = BHPS$JHLLT))
p2 <- p1 + geom_point()
p3 <- p2 + geom_smooth(method = "lm")
p4 <- p3 + ggtitle("Student's attitude versus exam points")
print(p4)

p5 <- ggplot(learning2014, aes(x = surf, y = Age, col = gender))
p6 <- p5 + geom_point()
p7 <- p6 + geom_smooth(method = "lm")
p8 <- p7 + ggtitle("Student's learning approach (surface) versus age")
p8
```


## and conclusions

## References 

Armstrong, J. (2002). Illusion in Regression Analysis. Forthcoming, International Journal of Forecasting. Philadelphia. Available at: http://www.academia.edu/1105970/Illusions_in_Regression_Analysis. Last accessed 29.1.2017

Frost, J. (2013). Regression Analysis: How Do I Interpret R-squared and Assess the Goodness-of-Fit?. The minitab blog. Available at: http://blog.minitab.com/blog/adventures-in-statistics-2/regression-analysis-how-do-i-interpret-r-squared-and-assess-the-goodness-of-fit. Last accessed 29.1.2017.

Nuzzo, R. (2014). Statistical errors. P values, ‘the gold standard’ of statistical validity, are not as reliable as many scientist assume. Nature. 306. 150-152.

Vehkalahti, K. (2015). The relationship between learning approaches and students’ achievements in an introductory statistics course in Finland. 60th World Statistics Congress, ISI2015. Rio de Janeiro.



